<!--<%@ page contentType="text/html;charset=UTF-8" language="java" pageEncoding="UTF-8"%>-->
<!DOCTYPE html>
<html>


<!-- Mirrored from www.zi-han.net/theme/hplus/login.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 20 Jan 2016 14:18:23 GMT -->
<head>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">


    <title>Citi</title>
    <link rel="shortcut icon" href="favicon.ico"> <link href="/css/bootstrap.min14ed.css?v=3.3.6" rel="stylesheet">
    <link href="/css/font-awesome.min93e3.css?v=4.4.0" rel="stylesheet">

    <link href="/css/animate.min.css" rel="stylesheet">
    <link href="/css/style.min862f.css?v=4.1.0" rel="stylesheet">
    <!--[if lt IE 9]>
    <meta http-equiv="refresh" content="0;ie.html" />
    <![endif]-->
    <script>if(window.top !== window.self){ window.top.location = window.location;}</script>
</head>

<body class="gray-bg">

<div class="middle-box text-center loginscreen  animated fadeInDown">
    <div>
        <div>

            <h1 class="logo-name">FE</h1>

        </div>
        <h3>Welcome to Citi Training!</h3>

        <form class="m-t" role="form" id ="loginForm">

            <div class="form-group">
                <input name= "loginName" id="loginName" type="text" class="form-control" placeholder="用户名" required="">
            </div>
            <div class="form-group">
                <input name="loginPwd" id="loginPwd" type="password" class="form-control" placeholder="密码" required="">
            </div>
            <div class="form-group">
                <select name="loginType" id="loginType" class="form-control">
                    <option>普通用户</option>
                    <option>管理员</option>
                </select>
            </div>

            <div id= "error" style="color: red;"></div>
            <a id="login" class="btn btn-primary block full-width m-b">登 录</a>
            <p class="text-muted text-center"> <a href="/views/login.jsp"><small>忘记密码了？</small></a> | <a href="/views/register.jsp">注册一个新账号</a>
            </p>
        </form>
    </div>
</div>
<script src="/js/jquery.min.js?v=2.1.4"></script>
<script src="/js/bootstrap.min.js?v=3.3.6"></script>
<script src="/js/jquery.serializejson.min.js"></script>
<script type="text/javascript" src="http://tajs.qq.com/stats?sId=9051096" charset="UTF-8"></script>
</body>
<script>

    $('#login').click(
        function () {
            var loginType = document.getElementById("loginType").value;
            var password = document.getElementById("loginPwd").value;
            if(loginType == "普通用户"){

                console.log($('#loginForm').serialize());
                console.log("普通用户登录");
                var role = 0

                $.ajax({
                    url: "/api/user/login",
                    type: "post",
                    data:  {
                        userName:$('#loginName').val(),
                        password:password,
                        role:role
                    },
                    success: function (data) {
                        let userName = $('#loginName').val();
                        if (data.code == 0) {
                            window.location.href='/api/main.html?&userName='+userName;
                        }
                        else
                        {
                            $('#error').html(data.message)
                        }
                    },
                    error: function (data) {
                        $('#error').html("登陆失败请稍后重试")
                    }
                })

            }else if(loginType == "管理员"){

                console.log($('#loginForm').serialize());
                console.log("管理员登录");
                var role = 1

                $.ajax({
                    url: "/api/user/login",
                    type: "post",
                    data:  {
                        userName:$('#loginName').val(),
                        password:$('#loginPwd').val(),
                        role:role
                    },
                    success: function (data) {
                        let adminName = $('#loginName').val();
                        if (data.code == 0) {
                            window.location.href='/api/mainAdmin.html?&adminName='+adminName;
                        }
                        else
                        {
                            $('#error').html(data.message)
                        }
                    },
                    error: function (data) {
                        $('#error').html("登陆失败请稍后重试")
                    }
                })

            }


        }
    )
</script>

<!-- Mirrored from www.zi-han.net/theme/hplus/login.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 20 Jan 2016 14:18:23 GMT -->
</html>
